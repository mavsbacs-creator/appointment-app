<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Professional Appointment Booking</title>
<style>
* { box-sizing: border-box; }

body {
  font-family: "Segoe UI", Arial, sans-serif;
  background: linear-gradient(135deg, #1f3d2b, #2e6b4f);
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  margin: 0;
}

.card {
  background: white;
  width: 400px;
  padding: 28px;
  border-radius: 14px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.25);
}

h1 {
  text-align: center;
  color: #1f3d2b;
  margin-bottom: 20px;
}

label {
  font-weight: 600;
  font-size: 14px;
  margin-top: 12px;
  display: block;
}

input, select {
  width: 100%;
  padding: 11px;
  margin-top: 6px;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-size: 14px;
}

button {
  margin-top: 22px;
  width: 100%;
  padding: 14px;
  background: #1f3d2b;
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
}

button:hover {
  background: #244f3e;
}

/* Modals */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.modal-box {
  background: white;
  width: 360px;
  padding: 24px;
  border-radius: 14px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.3);
}

.modal-box h2 {
  margin-top: 0;
  color: #1f3d2b;
  text-align: center;
}

.modal-box p {
  margin: 8px 0;
  font-size: 14px;
}

.modal-actions {
  margin-top: 18px;
  display: flex;
  gap: 10px;
}

.modal-actions button {
  flex: 1;
}

.secondary {
  background: #ccc;
  color: #333;
}

.secondary:hover {
  background: #b3b3b3;
}

option.disabled {
  color: #999;
}
</style>
</head>
<body>

<div class="card">
  <h1>Book Appointment</h1>

  <label>Date</label>
  <input type="date" id="date">

  <label>Time</label>
  <select id="timeSlots">
  </select>

  <label>Car Make</label>
  <input type="text" id="make" placeholder="e.g. Toyota">

  <label>Car Model</label>
  <input type="text" id="model" placeholder="e.g. Camry">

  <label>Car Color</label>
  <input type="text" id="color" placeholder="e.g. Black">

  <label>Service Address</label>
  <input type="text" id="address" placeholder="e.g. 123 Main St, Dallas TX">

  <button onclick="reviewAppointment()">Continue</button>
</div>

<!-- REVIEW MODAL -->
<div class="modal" id="reviewModal">
  <div class="modal-box">
    <h2>Review Your Appointment</h2>
    <p id="reviewDate"></p>
    <p id="reviewTime"></p>
    <p id="reviewCar"></p>
    <p id="reviewColor"></p>
    <p id="reviewAddress"></p>

    <div class="modal-actions">
      <button class="secondary" onclick="closeReview()">Edit</button>
      <button onclick="confirmAppointment()">Confirm</button>
    </div>
  </div>
</div>

<!-- FINAL CONFIRMATION -->
<div class="modal" id="finalModal">
  <div class="modal-box">
    <h2>Appointment Confirmed</h2>
    <p>âœ… Your appointment is booked.</p>
    <p id="finalSummary"></p>
    <button onclick="closeFinal()">Done</button>
  </div>
</div>

<script>
const bookings = JSON.parse(localStorage.getItem("bookings")) || {};
const dateInput = document.getElementById("date");
const timeSelect = document.getElementById("timeSlots");

dateInput.min = new Date().toISOString().split("T")[0];

// Generate all 30-min time slots 3:00 PM - 9:00 PM
function generateTimes() {
  const times = [];
  for (let h = 15; h <= 21; h++) {
    const hour = h > 12 ? h - 12 : h;
    times.push(`${hour}:00 PM`);
    if (h !== 21) times.push(`${hour}:30 PM`);
  }
  return times;
}

// Update time dropdown
function updateTimes() {
  timeSelect.innerHTML = "";
  const [y,m,d] = dateInput.value.split("-").map(Number);
  const now = new Date();
  const minTime = new Date(now.getTime() + 2*60*60*1000);
  const booked = bookings[dateInput.value] || [];

  generateTimes().forEach(time => {
    let [hm, p] = time.split(" ");
    let [h,min] = hm.split(":").map(Number);
    if (p === "PM" && h !== 12) h += 12;
    const slot = new Date(y,m-1,d,h,min);

    const opt = document.createElement("option");
    opt.value = time;
    opt.text = time;

    if ((slot < minTime && isSameDay(slot, now)) || booked.includes(time)) {
      opt.disabled = true;
      opt.className = "disabled";
    }
    timeSelect.appendChild(opt);
  });
}

function isSameDay(a,b) {
  return a.getFullYear()===b.getFullYear() && a.getMonth()===b.getMonth() && a.getDate()===b.getDate();
}

// Review appointment modal
function reviewAppointment() {
  const date = dateInput.value;
  const time = timeSelect.value;
  const make = document.getElementById("make").value.trim();
  const model = document.getElementById("model").value.trim();
  const color = document.getElementById("color").value.trim();
  const address = document.getElementById("address").value.trim();

  if (!date || !time || !make || !model || !color || !address) {
    alert("Please complete all fields.");
    return;
  }

  document.getElementById("reviewDate").innerText = `ðŸ“… Date: ${date}`;
  document.getElementById("reviewTime").innerText = `â± Time: ${time}`;
  document.getElementById("reviewCar").innerText = `ðŸš— Car: ${make} ${model}`;
  document.getElementById("reviewColor").innerText = `ðŸŽ¨ Color: ${color}`;
  document.getElementById("reviewAddress").innerText = `ðŸ“ Address: ${address}`;

  document.getElementById("reviewModal").style.display = "flex";
}

function closeReview() { document.getElementById("reviewModal").style.display="none"; }

function confirmAppointment() {
  const date = dateInput.value;
  const time = timeSelect.value;

  if (!bookings[date]) bookings[date]=[];
  bookings[date].push(time);
  localStorage.setItem("bookings", JSON.stringify(bookings));

  document.getElementById("reviewModal").style.display="none";
  document.getElementById("finalSummary").innerText = `${date} at ${time}`;
  document.getElementById("finalModal").style.display="flex";

  updateTimes();
}

function closeFinal() { document.getElementById("finalModal").style.display="none"; }

dateInput.addEventListener("change", updateTimes);

// initialize today
if(dateInput.value) updateTimes();
</script>

</body>
</html>
